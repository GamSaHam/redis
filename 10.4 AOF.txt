AOF(Append Only File)은 레디스에서 데이터의 영구 저장을 위하여 지원하는 두 번째 기능이다.
레디스가 수신하는 모든 쓰기 명령을 aof 파일에 기록하여 데이터를 보관한다.
마치 mysql의 bin log와 유사한 기능이다.
만약 정정과 같은 시스템 장애 때문에 마지막 명령의 기록이 완전하지 않을 때 레디스가 제공하는 redis-check-aof 툴을
사용하여 aof 파일의 잘못된 부분을 고칠 수 있다.

AOF는 스냅샷에 비해 더 나은 데이터 정합성을 보장한다. 스냅샷은 각 스냅샷 사이의 데이터를 잃어 버리지만
AOF는 최악의 상황에서 마지막 1초의 데이터만을 잃어 버린다.
flushall 명령과 같이 잘못 전달된 명령에 의하여 데이터를 완전히 잃어버리는 사태를 방지할 수 있다.
레디스 서버를 중지시키고 aof파일을 열어서 마지막 기록된 flushall 명령을 제거하고 레디스를 다시 시작하면
그만이다.

동일한 데이터를 aof 파일은 스냅샷에 비하여 더 많은 디스크 용량을 차지한다.

aof 파일 구조를 알아보도록 하자. appendonly 설정을 yes로 하여 인스턴스를 실행하자.

레디스를 사용할 떄는 메모리에 관한 설정에 유의해야 한다. 메모리 설정은 리눅스 시스템 커널과 밀접한 관련이
있다. 리눅스 시스템 엔지니이어의 조언을 받아서 메모리와 디스크에 대한 리눅스 설정을 최적화 해야 한다.







