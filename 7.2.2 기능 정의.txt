이벤트 이름, 이벤트 아이디, 방문 횟수
신난다 이벤트, 245, 455408
100000번째 방문 이벤트, 246, 12523

기능 정의
- 이벤트 페이지 방문 횟수 저장
- 모든 페이지의 방문 횟수 조회
- 개별 이벤트 페이지 방문 횟수 조회

7.2.3 기능 구현
레디스에서 숫자를 저장하고 증가시키기 위해서는 문자열 데이터형과 해시 데이터형을 사용할 수 있다.

event:click:554
event:click:total

추가 요구 사항
날짜, 방문 횟수, 전체 이벤트 페이지 방문 횟수(비율)
20130501, 11250, 104134(10.8%)

event:click:daily:20130513:554
event:click:daily:total:20130513

장바구니 정보
3장에서 살펴본 키-값 모델 NoSQL의 적절한 예로 사용자의 프로필 정보 저장, 웹 서버의 클러스터
를 위한 세션정보 저장, 장바구니 정보 저장, URL 단축 정보 저장을 예로 들었다.

이번장에서는 레디스를 사용하여 장바구니를 구현해 보자.

장바구니 정보를 담는 방법에는 문자열 데이터에 상품 정보 목록이 담긴 JSON 객체를 직렬화 하여

저장하는 방법과 해시 데이터에 개별 상품코드를 필드로 하여 저장하는 방법이 있다. 

이번절에서는 JSON 객체를 사용하여 구현해보도록 하자.

JSON 라이브러리 중에서 google-gson, Json-lib, JSON-Simple이 많이 사용된다.

그중에서 Json-simple 1.1 버전을 사용한다.

요구 사항
회원이 선택한 상품을 장바구니에 저장한다.
장바구니에는 상품번호, 상품명, 상품개수 정보를 저장한다.

장바구니에 저장된 상품 정보는 사용자가 저장한 시간으로 부터 3일간 유효하며
3일간 수정이 없으면 자동으로 삭제 된다.
장바구니에 이미 존재하는 상품을 다시 등록할 떄는 이전 저장된 상품이 삭제되고 새로운 상품이 저장된다.
각 사용자의 장바구니 상품 목록을 조회할 수 있어야 한다.

기능 정의
- 장바구니 상품 등록
- 장바구니 상품 삭제
- 장바구니 비우기
- 장바구니 상품 목록 조회
- 3일이 지난 상품 삭제

논리 모델로 구현하면
사용자(사용자번호 INT) -< 장바구니(상품개수 INT, 사용자번호 INT, 상품번호 INT) >- 상품(상품번호 INT)

기능구현
장바구니에 저장된 상품 정보 목록을 JSON 객체의 문자열로 저장하고 각 상품의 정보는 별도의
키에 저장하여 처리한다.

사용자번호와 상품번호는 숫자로 이루어져 있다.
아래 12521인 사용자번호를 가진 상품 151번과 234번을 장바구니에 저장했을 때 레디스에 생성되는
키의 목록이다.

12521:cart:product
// 상품목록에 저장되는 키는 <사용자번호>:cart:product 와 같이 구성되며
12521:cart:productid:151
12521:cart:productid:234
// 등록된 상품에 대한 정보는 <사용자번호>:cart:product:<상품번호>의 키에 저장된다.
3일이 지난 상품을 장바구니에 삭제하는 기능은 레디스의 expire 기능을 사용하여 자동으로 삭제되
되도록 처리한다. 그러므로 지정일이 지난 상품을 삭제하는 별도의 기능 구현은 필요하지 않다.

장바구니 정보를 저장하기 위한 키의 개수는 장바구니에 등록된 상품개수 + 1개다.

등록된 상품번호 목록이 저장되는 키가 이에 해당된다.











